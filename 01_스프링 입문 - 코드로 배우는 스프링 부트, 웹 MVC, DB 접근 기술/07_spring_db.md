# 스프링 DB 접근 기술

## H2 데이터베이스 설치
- 실무에서는 DB에 데이터를 저장 및 관리
- H2 데이터베이스: 개발이나 테스트 용도로 가볍고 편리한 DB, 웹 화면 제공
1) H2 Database Engine(All Platform) 다운로드
2) 다운로드 압축 풀기
3) `chmod 755 h2.sh` 실행하여 권한 변경 후 `./h2.sh` 실행
+) 웹 브라우저에서 url의 주소를 localhost로 변경하면 빠르게 접속 가능
4) 로그인 창의 JDBC URL은 파일의 경로를 의미. 사용자명, 비밀번호 그대로 두고 연결 선택(test.mv.db 생성됨)
5) test.mv.db 파일 존재 확인
6) `jdbc:h2:tcp://localhost/~/test`로 접근하여햐 함(파일충돌 방지)
7) SQL문으로 테이블 생성

```sql
drop table if exists member CASCADE;
create table member
(
    id bigint generated by default as identity, 
    name varchar(255),
    primary key (id)
);
```

8) 생성된 테이블 조회

```sql
select * from member;
```

9) 테이블에 값 추가

```sql
insert into member(name) values('spring');
```
10) spring 프로젝트 외부에 sql 폴더 생성하여 관리
11) ddl.sql 생성하여 sql문 관리

## 순수 JDBC
- java에서 db랑 연동시 jdbc는 필수
1) `build.gradle` 파일에 jdbc, h2 database 라이브러리 추가
```
implementation 'org.springframework.boot:spring-boot:spring-boot-starter-jdbc'
runtimeOnly 'com.h2database:h2'
```

2) `resources/application.properties`에 스프링 부트 데이터베이스 연결 설정 추가
```
spring.satasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.driver-class-name=org.h2.Driver
```

3) src > main > java > hello.hellospring.repository에 JdbcMemberRepository(class) 생성
4) src > main > java > hello.hellospring의 SpringConfig(class) Repository 코드 수정
5) h2.sh 실행되는 상태로 프로젝트 실행


- MemberService는 MemberRepository에 의존
- MemberRepository의 구현체로 MemoryMemberRepository, JdbcMemberRepository가 있음
- OCP(개방-폐쇄원칙) 적용
- 스프링의 DI를 사용하면 기존 코드 변경 없이 설정만으로 구현 클래스를 변경할 수 있음

## 스프링 통합 테스트


## 스프링 JdbcTemplate

## JPA

## 스프링 데이터 JPA
